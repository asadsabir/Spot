<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Sort your Music</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kaushan+Script">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
</head>

<body id="page-top">
    <header class="masthead" style="background: url(https://www.b2w.tv/hubfs/music_01-05.jpg), url(https://cdn.bootstrapstudio.io/placeholders/1400x800.png) center / contain, url(https://cdn.bootstrapstudio.io/placeholders/1400x800.png);">
        <div class="container">
            <div class="intro-text">
                <div class="intro-lead-in"><span>Welcome!</span></div>
                <div class="intro-heading text-uppercase"><span>Sort your music</span></div><a class="btn btn-primary btn-xl text-uppercase" role="button" href="/login">Log in to spotify to start</a></div>
        </div>
    </header>
    <section id="services">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="text-uppercase section-heading">Take control of your Music</h2>
                </div>
            </div>
            <div class="row text-center">
                <div class="col-md-4"><span class="fa-stack fa-4x"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-shopping-cart fa-stack-1x fa-inverse"></i></span>
                    <h4 class="section-heading">Make a Custom Playlist</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
                <div class="col-md-4"><span class="fa-stack fa-4x"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-laptop fa-stack-1x fa-inverse"></i></span>
                    <h4 class="section-heading">Reorder a playlist</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
                <div class="col-md-4"><span class="fa-stack fa-4x"><i class="fa fa-circle fa-stack-2x text-primary"></i><i class="fa fa-lock fa-stack-1x fa-inverse"></i></span>
                    <h4 class="section-heading">Discover New Music</h4>
                    <p class="text-muted">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Minima maxime quam architecto quo inventore harum ex magni, dicta impedit.</p>
                </div>
            </div>
        </div>
    </section>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script src="assets/js/agency.js"></script>
    <script>
        function getHashParams() {
        var hashParams = {};
        var e, r = /([^&;=]+)=?([^&;]*)/g,
            q = window.location.hash.substring(1);
        while ( e = r.exec(q)) {
            hashParams[e[1]] = decodeURIComponent(e[2]);
        }
        console.log(hashParams);
        return hashParams;
      }

      var userInfo = {};
      var userplaylists = [];
      var params = getHashParams();

      var access_token = params.access_token,
          refresh_token = params.refresh_token,
          error = params.error;

      if (error) {
        alert('There was an error during the authentication');
      } else {
            if(access_token){
                setTimeout(() => {
                    window.location.replace(access_token)
                }, 1000);
                $.ajax({
                    url: '/loggg',
                    data: access_token,
                    success: function(response) {
                        console.log(response);
                        /*window.location.replace('http://localhost:8888/loggg?' + $.param(response))
                        console.log($.param(response))
                        userInfo = response
                        console.log(response);
                        $.ajax({
                            url:'/loggg',
                            data: response,
                            success: (f) => {console.log(f)}
                        })*/
                    }
                });
            } else {
                // render initial screen
                $('#login').show();
                $('#playlists').hide();
            }

         /*document.getElementById('obtain-new-token').addEventListener('click', function() {
          $.ajax({
            url: '/refresh_token',
            data: {
              'refresh_token': refresh_token
            }
          }).done(function(data) {
            access_token = data.access_token;
            console.log(data);
          });
            }, false);*/
        }
    </script>
</body>

</html>